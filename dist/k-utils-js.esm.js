import e from"axios";import{Utils as t}from"k-utils-js";import n from"moment";function r(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&-1===t.indexOf(r)&&(n[r]=e[r]);return n}var o=function(){};o.setDefaultHeaders=function(){var t=document.querySelector('meta[name="csrf-token"]');t&&(e.defaults.headers.common["X-CSRF-Token"]=t.content),e.defaults.headers.common.Accept="application/json",e.defaults.headers.common["X-Requested-With"]="XMLHttpRequest"},o.setCancelToken=function(n){var r=this.getCancelToken(n);t.isBlank(r)||r.cancel(n+" request canceled by the user."),this.cancelTokenSources[n]=e.CancelToken.source()},o.getCancelToken=function(e){return this.cancelTokenSources[e]},o.later=function(e,t){return new Promise((function(n){setTimeout(n,e,t)}))},o.axiosRequest=function(t){var n=t.onSuccess,o=t.onError,i=r(t,["onSuccess","onError"]);return new Promise((function(t){return e(i).then((function(e){n(e),t()})).catch((function(e){o(e),t()}))}))},o.sendRequest=function(e){var n=e.delay,o=e.url,i=r(e,["delay","url"]);this.setDefaultHeaders(),this.setCancelToken(o);var u=this.getCancelToken(o).token,s=Object.assign(i,{url:o,cancelToken:u}),c=300;return window&&window.AppInfo&&"test"===AppInfo.railsEnv&&(c=0),t.isTruthy(n)&&c>0?this.later(c,s).then(this.axiosRequest):this.axiosRequest(s)},o.cancelTokenSources={},o.active=0,e.interceptors.request.use((function(e){return o.active+=1,e}),(function(e){return o.active-=1,Promise.reject(e)})),e.interceptors.response.use((function(e){return o.active-=1,e}),(function(e){return o.active-=1,Promise.reject(e)})),window.Api=o;var i={isString:function(e){return"string"==typeof e},isUndefined:function(e){return void 0===e},isUndefinedOrNull:function(e){return this.isUndefined(e)||null===e},isEmpty:function(e){return this.isObject(e)?0===Object.keys(e).length:this.isString(e)?0===e.length:void 0},isNotEmpty:function(e){return!this.isEmpty(e)},isBlank:function(e){return this.isUndefinedOrNull(e)||this.isEmpty(e)},isFalsy:function(e){return this.isBlank(e)||!1===e},isTruthy:function(e){return!this.isFalsy(e)},isUUID:function(e){return"string"==typeof e&&/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/.test(e)},toUnderscore:function(e){return"string"==typeof e?e.replace(/([A-Z])/g,(function(e){return"_"+e.toLowerCase()})):e},toLowerCamelCase:function(e){return"string"==typeof e?e.replace(/(_[a-z])/g,(function(e){return e.toUpperCase().replace("_","")})):e},isObject:function(e){return"object"==typeof e},isArray:function(e){return e.constructor===Array},isFunction:function(e){return"function"==typeof e},noop:function(){},getMaxOfArray:function(e){return Math.max.apply(null,e)},compareStrings:function(e,t){return e.localeCompare(t)},compareNumbers:function(e,t){return e-t},generateIntegerHashFromString:function(e){for(var t=5381,n=e.length;n;)t=33*t^e.charCodeAt(--n);return t>>>0},dateHasIsoFormat:function(e){return e.match(/^\d{4}[\-](0[1-9]|1[012])[\-](0[1-9]|[12][0-9]|3[01])$/)},dateTimeHasIsoFormat:function(e){return e.match(/^\d{4}[\-](0[1-9]|1[012])[\-](0[1-9]|[12][0-9]|3[01]) ([01][0-9]|2[0-3]):([0-5][0-9])$/)},dateTimeHasStrictISO8601Format:function(e){return!n(e,"YYYY-MM-DD HH:mm",!0).isValid()},dateHasCustomFormat:function(e){return e.match(/^(0?[1-9]|[12][0-9]|3[01])[\/](0?[1-9]|1[012])[\/]\d{4}$/)},dateTimeHasCustomFormat:function(e){return e.match(/^(0?[1-9]|[12][0-9]|3[01])[\/](0?[1-9]|1[012])[\/]\d{4} (0?[0-9]|1[0-9]|2[0-3]):([0-5][0-9])$/)},count:function(e,t,n,r){void 0===e&&(e=0),void 0===t&&(t=1),void 0===n&&(n=1),void 0===r&&(r=[]);for(var o=[],i=e;i<=t;i+=n)!r.includes(i)&&o.push(i);return o},compareBy:function(e){return function(t,n){return t[e]<n[e]?-1:t[e]>n[e]?1:0}},dotify:function(e){return e.replace(/\[/g,".").replace(/]/g,"")}},u=Object.freeze({__proto__:null,Api:o,Utils:i});var s={install:function e(t){e.installed||(e.installed=!0,Object.keys(u).forEach((function(e){t.component(e,u[e])})))}},c=null;"undefined"!=typeof window?c=window.Vue:"undefined"!=typeof global&&(c=global.Vue),c&&c.use(s);export default s;export{o as Api,i as Utils};
